import{f as D,r as l,x as M,j as e,m as R,C as $,t as _,T as k,S as v,s as E,y as I,b as L,Z as z,E as F,U,D as W,o as B}from"./index-DGVu5RhP.js";import{n as O}from"./index-B1g217iS.js";import{l as P}from"./index-TjCxX7sJ.js";import{d as Z}from"./middleware-C1IJlFYS.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=D("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function J(s="http://localhost:10000"){const[i,t]=l.useState(null),[r,n]=l.useState(!1),[h,p]=l.useState(null),y=l.useCallback(()=>{if(!i){const o=P(s,{transports:["websocket","polling"],timeout:2e4,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});o.on("connect",()=>{n(!0),console.log("WebSocket connected to:",s)}),o.on("disconnect",c=>{n(!1),console.log("WebSocket disconnected:",c)}),o.on("connect_error",c=>{console.error("WebSocket connection error:",c),n(!1)}),o.onAny((c,g)=>{p({type:c,data:g,timestamp:Date.now()})}),t(o)}},[s,i]),m=l.useCallback(()=>{i&&(i.disconnect(),t(null),n(!1))},[i]),d=l.useCallback((o,c)=>{i&&r?i.emit(o,c):console.warn("Cannot send message: WebSocket not connected")},[i,r]);return l.useEffect(()=>()=>{m()},[m]),{socket:i,isConnected:r,lastMessage:h,sendMessage:d,connect:y,disconnect:m}}const V=M()(Z((s,i)=>({isConnected:!1,securityMetrics:null,alerts:[],complianceStatus:null,selectedTimeRange:"24h",filterSeverity:null,filterType:null,setIsConnected:t=>s({isConnected:t},!1,"setIsConnected"),setSecurityMetrics:t=>s({securityMetrics:t},!1,"setSecurityMetrics"),addAlert:t=>s(r=>({alerts:[t,...r.alerts].slice(0,100)}),!1,"addAlert"),clearAlerts:()=>s({alerts:[]},!1,"clearAlerts"),setComplianceStatus:t=>s({complianceStatus:t},!1,"setComplianceStatus"),setTimeRange:t=>s({selectedTimeRange:t},!1,"setTimeRange"),setFilterSeverity:t=>s({filterSeverity:t},!1,"setFilterSeverity"),setFilterType:t=>s({filterType:t},!1,"setFilterType"),filteredAlerts:()=>{const{alerts:t,filterSeverity:r,filterType:n,selectedTimeRange:h}=i(),p=new Date,y={"1h":1*60*60*1e3,"24h":24*60*60*1e3,"7d":7*24*60*60*1e3,"30d":30*24*60*60*1e3},m=p.getTime()-y[h];return t.filter(d=>!(new Date(d.timestamp).getTime()<m||r&&d.severity!==r||n&&d.type!==n))},criticalAlertsCount:()=>{const{alerts:t}=i();return t.filter(r=>r.severity==="critical").length},highRiskTransactions:()=>{const{alerts:t}=i();return t.filter(r=>r.type==="fraud"&&(r.severity==="high"||r.severity==="critical"))}}),{name:"security-store",partialize:s=>({selectedTimeRange:s.selectedTimeRange,filterSeverity:s.filterSeverity,filterType:s.filterType})})),X={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"},G={primary:"border-blue-500",secondary:"border-gray-400",accent:"border-cyan-400"};function b({size:s="md",color:i="primary",className:t=""}){return e.jsx("div",{className:`flex items-center justify-center ${t}`,children:e.jsx(R.div,{className:`
          ${X[s]}
          ${G[i]}
          border-2 border-t-transparent rounded-full
        `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})})}const ee=()=>{var w;const{securityMetrics:s,alerts:i,complianceStatus:t,isConnected:r,setSecurityMetrics:n,addAlert:h,setComplianceStatus:p}=V(),[y,m]=l.useState(!0),[d,o]=l.useState(null),[c,g]=l.useState(null),{sendMessage:N}=J();l.useEffect(()=>{const a=setInterval(()=>{n({agent_status:"active",fraud_alerts_24h:Math.floor(Math.random()*10),security_events_24h:Math.floor(Math.random()*50),risk_threshold:Math.random()*100,last_scan:new Date().toISOString(),systems_operational:!0})},3e4);return()=>clearInterval(a)},[]),l.useEffect(()=>{m(!1)},[]),l.useEffect(()=>{r&&(async()=>{try{const f=await fetch("/api/security/status");if(f.ok){const x=await f.json();x.success&&n(x.data.security_metrics)}const S=await fetch("/api/security/alerts?limit=20");if(S.ok){const x=await S.json();x.success&&x.data.alerts.forEach(u=>h({id:u.id||Date.now().toString(),type:u.alert_type,severity:u.severity,message:u.message||`${u.alert_type} event`,timestamp:u.detected_at,details:u}))}const C=await fetch("/api/security/compliance/status");if(C.ok){const x=await C.json();x.success&&p(x.data)}}catch(f){console.error("Error loading security data:",f),O.error("Failed to load security data")}finally{m(!1)}})()},[r,n,h,p]);const T=l.useCallback(()=>{o("Initiating fraud detection scan..."),N("request_fraud_scan",{user_id:"admin"})},[N]),A=l.useMemo(()=>s?[{title:"Agent Status",value:s.agent_status,icon:s.agent_status==="running"?$:_,color:s.agent_status==="running"?"text-green-400":"text-red-400",bgColor:s.agent_status==="running"?"bg-green-400/10":"bg-red-400/10"},{title:"Fraud Alerts (24h)",value:s.fraud_alerts_24h,icon:k,color:s.fraud_alerts_24h>10?"text-red-400":"text-yellow-400",bgColor:s.fraud_alerts_24h>10?"bg-red-400/10":"bg-yellow-400/10"},{title:"Security Events (24h)",value:s.security_events_24h,icon:v,color:s.security_events_24h>20?"text-red-400":"text-blue-400",bgColor:s.security_events_24h>20?"bg-red-400/10":"bg-blue-400/10"},{title:"Risk Threshold",value:`${(s.risk_threshold*100).toFixed(0)}%`,icon:E,color:"text-accent-cyan",bgColor:"bg-accent-cyan/10"}]:[],[s]),j=l.useMemo(()=>i.slice(0,10).map(a=>({...a,severityColor:{critical:"text-red-400 bg-red-400/10",high:"text-orange-400 bg-orange-400/10",medium:"text-yellow-400 bg-yellow-400/10",low:"text-blue-400 bg-blue-400/10"}[a.severity]||"text-gray-400 bg-gray-400/10"})),[i]);return y?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(b,{size:"lg"})}):e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-8 h-8 text-accent-cyan"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Security Center"}),e.jsx("p",{className:"text-text-dim",children:"Real-time fraud detection and security monitoring"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${r?"bg-green-400/10 text-green-400":"bg-red-400/10 text-red-400"}`,children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:r?"Connected":"Disconnected"})]}),e.jsxs("button",{onClick:T,disabled:!!d,className:`flex items-center gap-2 px-4 py-2 bg-accent-cyan/10 text-accent-cyan \r
                       hover:bg-accent-cyan/20 transition-colors rounded-lg disabled:opacity-50`,children:[e.jsx(z,{className:"w-4 h-4"}),d?"Scanning...":"Run Fraud Scan"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:A.map((a,f)=>e.jsx("div",{className:"bg-surface rounded-xl p-6 border border-surface hover:border-accent-cyan/30 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim text-sm font-medium",children:a.title}),e.jsx("p",{className:"text-2xl font-bold text-text-primary mt-1",children:a.value})]}),e.jsx("div",{className:`p-3 rounded-lg ${a.bgColor}`,children:e.jsx(a.icon,{className:`w-6 h-6 ${a.color}`})})]})},f))}),d&&e.jsx("div",{className:"bg-yellow-400/10 border border-yellow-400/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{size:"sm"}),e.jsx("span",{className:"text-yellow-400 font-medium",children:d})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-surface",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Recent Security Alerts"}),e.jsxs("div",{className:"flex items-center gap-2 text-text-dim",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Live monitoring"})]})]}),e.jsx("div",{className:"space-y-3",children:j.length>0?j.map(a=>e.jsxs("div",{className:`flex items-start gap-4 p-4 bg-bg-alt rounded-lg border border-surface \r
                               hover:border-accent-cyan/30 transition-colors cursor-pointer`,onClick:()=>g(a),children:[e.jsx("div",{className:`p-2 rounded-full ${a.severityColor}`,children:e.jsx(k,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.severityColor}`,children:a.severity.toUpperCase()}),e.jsx("span",{className:"text-xs text-text-dim",children:new Date(a.timestamp).toLocaleTimeString()})]}),e.jsx("p",{className:"text-text-primary font-medium truncate",children:a.message}),e.jsxs("p",{className:"text-text-dim text-sm capitalize",children:[a.type," alert"]})]})]},a.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"w-12 h-12 text-text-dim mx-auto mb-3"}),e.jsx("p",{className:"text-text-dim",children:"No recent security alerts"})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-surface",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Compliance Score"}),t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-4xl font-bold ${t.overall_score>=90?"text-green-400":t.overall_score>=70?"text-yellow-400":"text-red-400"}`,children:[t.overall_score,"%"]}),e.jsx("p",{className:"text-text-dim text-sm",children:"Overall compliance"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim",children:"Total Issues"}),e.jsx("p",{className:"text-text-primary font-semibold",children:t.total_issues})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim",children:"Critical"}),e.jsx("p",{className:"text-red-400 font-semibold",children:t.critical_issues})]})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(b,{size:"sm"}),e.jsx("p",{className:"text-text-dim text-sm mt-2",children:"Loading compliance data..."})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-surface",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Security Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-accent-cyan"}),e.jsx("span",{className:"text-text-dim",children:"Active Sessions"})]}),e.jsx("span",{className:"text-text-primary font-semibold",children:"247"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-text-dim",children:"Blocked IPs"})]}),e.jsx("span",{className:"text-text-primary font-semibold",children:"12"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{className:"text-text-dim",children:"Blocked Amount"})]}),e.jsx("span",{className:"text-text-primary font-semibold",children:"$2,340"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-text-dim",children:"Last Update"})]}),e.jsx("span",{className:"text-text-primary font-semibold",children:"2m ago"})]})]})]})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface rounded-xl p-6 max-w-2xl w-full mx-4 border border-surface",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Alert Details"}),e.jsx("button",{onClick:()=>g(null),className:"text-text-dim hover:text-text-primary transition-colors",children:e.jsx(_,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim text-sm",children:"Type"}),e.jsx("p",{className:"text-text-primary font-medium capitalize",children:c.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim text-sm",children:"Severity"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(w=j.find(a=>a.id===c.id))==null?void 0:w.severityColor}`,children:c.severity.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim text-sm",children:"Timestamp"}),e.jsx("p",{className:"text-text-primary font-medium",children:new Date(c.timestamp).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim text-sm mb-2",children:"Message"}),e.jsx("p",{className:"text-text-primary",children:c.message})]}),c.details&&e.jsxs("div",{children:[e.jsx("p",{className:"text-text-dim text-sm mb-2",children:"Details"}),e.jsx("pre",{className:"bg-bg-alt rounded-lg p-3 text-xs text-text-primary overflow-x-auto",children:JSON.stringify(c.details,null,2)})]})]})]})})]})})};export{ee as default};
//# sourceMappingURL=SecurityModule-By3MsNj1.js.map
