import{f as b,r as l,a as G,j as e,R,n as _,m as p,U as W,C as z,o as B,p as c,q as U}from"./index-DGVu5RhP.js";import{M as Y,P as J}from"./play-Ck6oZYSy.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=b("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=b("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=b("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function ee(){const[d,f]=l.useState([]),[j,y]=l.useState([]),[v,N]=l.useState(!0),[S,g]=l.useState(null),[A,k]=l.useState(null),{isConnected:M}=G(),E=t=>{const s=[],r=a=>{if(!a||typeof a!="object")return!1;const n=a,i=n.id??n.agent_id??n.uuid??n.slug,o=n.status??n.agent_status,h=n.type??n.agent_type;return!(typeof i!="string"||i.length===0||typeof o!="string"&&typeof h!="string"&&typeof n.name!="string")};if(Array.isArray(t))s.push(...t);else if(t&&typeof t=="object"){const a=t;if(Array.isArray(a.agents)&&s.push(...a.agents),Array.isArray(a.data)&&s.push(...a.data),typeof a.data=="object"&&a.data!==null){const n=a.data;Array.isArray(n.agents)&&s.push(...n.agents),Array.isArray(n.results)&&s.push(...n.results)}Array.isArray(a.results)&&s.push(...a.results),s.length===0&&r(a)&&s.push(a)}return s.filter(a=>r(a))},C=t=>{if(!t||typeof t!="object")return c.warn("Agents data invalid type, triggering fallback",{event:"AGENTS_DATA_INVALID",rawData:typeof t,context:"AgentsModule.validateAndProcessAgentsData"}),[];const s=E(t);return s.length===0?(c.warn("No agents data available, triggering empty state recovery",{event:"AGENTS_DATA_EMPTY",rawData:t,context:"AgentsModule.validateAndProcessAgentsData"}),[]):(c.info("Successfully processed agents data",{event:"AGENTS_DATA_PROCESSED",count:s.length,context:"AgentsModule.validateAndProcessAgentsData"}),s)},w=async(t=0)=>{const r=Math.pow(2,t)*1e3;try{c.info("Starting agent data fetch",{event:"AGENTS_FETCH_START",attempt:t+1,maxRetries:4,context:"AgentsModule.fetchAgentDataWithRecovery"});const a=await Promise.race([fetch("/v1/agents"),new Promise((x,q)=>setTimeout(()=>q(new Error("Fetch timeout")),1e4))]);let n=[];if(a.ok){const x=await a.json();n=C(x)}else throw new Error(`HTTP ${a.status}: ${a.statusText}`);const i=P(n);if(i.length===0){c.info("No agent records available after processing, skipping auxiliary fetches",{event:"AGENTS_EMPTY_DATASET",context:"AgentsModule.fetchAgentDataWithRecovery"}),f([]),y([]),g(null);return}const o=await I(i),h=await D(),m=F(i,h);f(m),y(o),g(null),c.info("Agent data fetch completed successfully",{event:"AGENTS_FETCH_SUCCESS",agentCount:m.length,sessionCount:o.length,context:"AgentsModule.fetchAgentDataWithRecovery"})}catch(a){if(c.error("Agent data fetch failed",{event:"AGENTS_FETCH_ERROR",attempt:t+1,maxRetries:4,error:String(a),context:"AgentsModule.fetchAgentDataWithRecovery"}),t<3){c.info("Triggering automatic retry with exponential backoff",{event:"AGENTS_FETCH_RETRY",retryCount:t+1,retryDelay:r,context:"AgentsModule.fetchAgentDataWithRecovery"}),setTimeout(()=>{w(t+1)},r);return}c.error("All retry attempts exhausted, entering error state",{event:"AGENTS_FETCH_FINAL_FAILURE",totalAttempts:4,context:"AgentsModule.fetchAgentDataWithRecovery"}),g(a instanceof Error?a.message:"Unknown error"),f([]),y([])}},P=t=>t.map((s,r)=>{const a=s.total_executions||0,n=s.successful_executions||0,i=s.failed_executions||0,o=s.avg_execution_time||0,h=a>0?n/a*100:0,m=a>0?i/a*100:0,x=Math.max(0,Math.min(100,100-m));return{id:s.id||`agent_${r}`,name:s.name||`Agent ${r+1}`,type:s.type||s.agent_type||"Unknown",status:s.status||"idle",health:Math.floor(x),lastActivity:s.last_execution||s.updated_at||new Date().toISOString(),totalTasks:a,completedTasks:n,errorCount:i,performance:{avgResponseTime:Math.floor(o*1e3),successRate:Math.floor(h*10)/10,throughput:s.throughput_per_hour||0},capabilities:s.capabilities||O(s.type||s.agent_type||"unknown")}}),I=async t=>{if(t.length===0)return[];try{const s=t[0].id,r=await fetch(`/v1/agents/${s}/logs`);if(r.ok){const a=await r.json();return U(a)}}catch(s){c.warn("Failed to fetch sessions, using empty array fallback",{event:"SESSIONS_FETCH_ERROR",error:String(s),context:"AgentsModule.fetchSessionsData"})}return[]},D=async()=>{try{const t=await fetch("/v1/metrics");if(t.ok)return await t.json()}catch(t){c.warn("Failed to fetch metrics, using null fallback",{event:"METRICS_FETCH_ERROR",error:String(t),context:"AgentsModule.fetchMetricsData"})}return null},F=(t,s)=>{const r=[...t];return(s==null?void 0:s.active_sessions)>0&&r.push({id:"system_orchestrator",name:"System Orchestrator",type:"Core System",status:"active",health:s.ok?95:60,lastActivity:new Date().toISOString(),totalTasks:s.total_requests||0,completedTasks:Math.floor((s.total_requests||0)*.95),errorCount:s.total_errors||0,performance:{avgResponseTime:120,successRate:((s.total_requests||0)-(s.total_errors||0))/Math.max(s.total_requests||1,1)*100,throughput:s.active_sessions||0},capabilities:["Request Orchestration","Session Management","Error Handling"]}),r},u=async()=>{N(!0),g(null),await w(),N(!1)},$=async()=>{var t;try{const s=A||(((t=d[0])==null?void 0:t.id)??"quantum-001"),r=await fetch(`/v1/agents/${s}/run`,{method:"POST",headers:{"Content-Type":"application/json"}});r.ok&&(await r.json(),u())}catch(s){console.error("Failed to create agent session:",s)}},T=t=>{switch(t){case"active":return"text-green-400";case"idle":return"text-yellow-400";case"error":return"text-red-400";case"stopped":return"text-gray-400";default:return"text-gray-400"}},H=t=>{switch(t){case"active":return J;case"idle":return K;case"error":return _;case"stopped":return Q;default:return B}},L=t=>{const s=new Date(t),a=new Date().getTime()-s.getTime(),n=Math.floor(a/6e4);if(n<1)return"Just now";if(n<60)return`${n}m ago`;const i=Math.floor(n/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`},O=t=>({product_research:["Product Discovery","Market Analysis","Trend Identification","Competitor Research"],inventory_forecasting:["Demand Prediction","Stock Management","Prophet Forecasting","Shopify Integration"],marketing_automation:["Email Campaigns","Customer Segmentation","A/B Testing","Behavioral Triggers"],order_management:["Risk Assessment","Supplier Routing","Tracking Sync","Return Processing"],pricing_optimizer:["Competitive Analysis","Dynamic Pricing","Margin Optimization","Market Intelligence"],analytics:["Revenue Analytics","Performance Tracking","Business Intelligence","Report Generation"],customer_support:["AI Chat","Ticket Resolution","Knowledge Base","Escalation Management"],security:["Fraud Detection","Risk Assessment","Compliance Monitoring","Threat Analysis"]})[t]||["Task Processing","Data Analysis","Automation"];return l.useEffect(()=>{u();const t=setInterval(u,15e3);return()=>clearInterval(t)},[]),v&&d.length===0?e.jsx("div",{className:"min-h-screen bg-black text-white p-6 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(R,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-cyan-400",children:"Loading Agent Management System..."})]})}):S&&d.length===0?e.jsx("div",{className:"min-h-screen bg-black text-white p-6 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-8 h-8 text-red-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-red-400 mb-4",children:"Failed to load agent data"}),e.jsx("p",{className:"text-gray-400 mb-4",children:S}),e.jsx("button",{onClick:u,className:"px-4 py-2 bg-cyan-600/20 border border-cyan-500/30 text-cyan-300 rounded-lg hover:bg-cyan-600/30",children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-black text-white p-6",children:[e.jsx(p.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Agent Management"}),e.jsx("p",{className:"text-lg text-gray-400",children:"Deploy, monitor, and optimize AI agents across your empire"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-900/40 rounded-lg border border-gray-700/30",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${M?"bg-green-400":"bg-red-400"} animate-pulse`}),e.jsxs("span",{className:"text-sm font-mono",children:[d.filter(t=>t.status==="active").length," Active"]})]}),e.jsxs("button",{onClick:$,className:"px-4 py-2 bg-purple-600/20 border border-purple-500/30 text-purple-300 rounded-lg hover:bg-purple-600/30 flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),"New Session"]}),e.jsx("button",{onClick:u,disabled:v,className:"p-2 text-gray-400 hover:text-cyan-400 rounded-lg hover:bg-gray-800/60 disabled:opacity-50",children:e.jsx(R,{className:`w-5 h-5 ${v?"animate-spin":""}`})})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:d.map((t,s)=>{const r=H(t.status);return e.jsxs(p.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:s*.1},onClick:()=>k(A===t.id?null:t.id),className:"bg-gray-900/40 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30 hover:border-purple-400/30 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative p-3 rounded-lg bg-black/40",children:[e.jsx(W,{className:"w-6 h-6 text-purple-400"}),e.jsx(r,{className:`w-3 h-3 absolute -top-1 -right-1 ${T(t.status)}`})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-400",children:t.type})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-mono ${T(t.status)} uppercase`,children:t.status}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Health: ",t.health,"%"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Tasks Completed:"}),e.jsxs("span",{className:"text-green-400 font-mono",children:[t.completedTasks,"/",t.totalTasks]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Success Rate:"}),e.jsxs("span",{className:"text-cyan-400 font-mono",children:[t.performance.successRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Last Activity:"}),e.jsx("span",{className:"text-white font-mono",children:L(t.lastActivity)})]})]}),A===t.id&&e.jsx(p.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-gray-700/50",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:"Performance Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-black/40 p-2 rounded",children:[e.jsx("div",{className:"text-gray-400",children:"Avg Response"}),e.jsxs("div",{className:"text-white font-mono",children:[t.performance.avgResponseTime,"ms"]})]}),e.jsxs("div",{className:"bg-black/40 p-2 rounded",children:[e.jsx("div",{className:"text-gray-400",children:"Throughput"}),e.jsxs("div",{className:"text-white font-mono",children:[t.performance.throughput,"/min"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:"Capabilities"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.capabilities.map((a,n)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-purple-500/20 text-purple-300 rounded-full",children:a},n))})]})]})})]},t.id)})}),j.length>0&&e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-gray-900/40 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30",children:[e.jsxs("h2",{className:"text-xl font-bold text-purple-400 mb-6 flex items-center",children:[e.jsx(Y,{className:"w-5 h-5 mr-2"}),"Active Agent Sessions"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map((t,s)=>e.jsxs("div",{className:"p-4 bg-black/40 rounded-lg border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-mono text-sm text-white",children:["Session ",t.id.slice(-8)]}),e.jsx(z,{className:"w-4 h-4 text-green-400"})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Status: ",e.jsx("span",{className:"text-green-400",children:t.status})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Created: ",new Date(t.created_at).toLocaleString()]})]},t.id))})]})]})}export{ee as default};
//# sourceMappingURL=AgentsModule-GLFni06V.js.map
